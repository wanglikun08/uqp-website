class BagOfWordsDemo{constructor(){this.wordToIndex=new Map,this.dictionarySize=0,this.dictionaryLoaded=!1,this.sentence1Data=null,this.sentence2Data=null,this.elements={sentence1Input:document.getElementById("sentence1-input"),sentence2Input:document.getElementById("sentence2-input"),analyze1Btn:document.getElementById("analyze1-btn"),analyze2Btn:document.getElementById("analyze2-btn"),compareBtn:document.getElementById("compare-btn"),sentence1Mapping:document.getElementById("sentence1-mapping"),sentence2Mapping:document.getElementById("sentence2-mapping"),sentence1Indices:document.getElementById("sentence1-indices"),sentence2Indices:document.getElementById("sentence2-indices"),similarityValue:document.getElementById("similarity-value"),comparisonNote:document.getElementById("comparison-note"),dictSize:document.getElementById("dict-size"),loadingStatus:document.getElementById("loading-status")},this.init()}async init(){console.log("Initializing Bag of Words demo..."),await this.loadDictionary(),this.setupEventListeners(),console.log("Bag of Words demo initialized")}async loadDictionary(){try{this.elements.loadingStatus.textContent="Loading dictionary...";const response=await fetch("dict.csv"),lines=(await response.text()).trim().split("\n");for(let i=1;i<lines.length;i++){const word=lines[i].trim();word&&this.wordToIndex.set(word.toLowerCase(),i-1)}this.dictionarySize=this.wordToIndex.size,this.dictionaryLoaded=!0,this.elements.dictSize.textContent=this.dictionarySize.toLocaleString(),this.elements.loadingStatus.textContent="Dictionary loaded successfully!",this.elements.loadingStatus.style.color="#28a745",console.log(`Dictionary loaded: ${this.dictionarySize} words`)}catch(error){console.error("Error loading dictionary:",error),this.elements.loadingStatus.textContent="Error loading dictionary!",this.elements.loadingStatus.style.color="#dc3545"}}setupEventListeners(){this.elements.analyze1Btn.addEventListener("click",()=>this.analyzeSentence(1)),this.elements.analyze2Btn.addEventListener("click",()=>this.analyzeSentence(2)),this.elements.compareBtn.addEventListener("click",()=>this.compareSentences()),this.elements.sentence1Input.addEventListener("keypress",e=>{"Enter"===e.key&&this.analyzeSentence(1)}),this.elements.sentence2Input.addEventListener("keypress",e=>{"Enter"===e.key&&this.analyzeSentence(2)})}tokenize(text){return text.toLowerCase().replace(/[^\w\s]/g,"").split(/\s+/).filter(word=>word.length>0)}analyzeSentence(sentenceNum){if(!this.dictionaryLoaded)return void alert("Dictionary is still loading. Please wait...");const text=1===sentenceNum?this.elements.sentence1Input.value:this.elements.sentence2Input.value;if(!text.trim())return void alert("Please enter a sentence first.");const tokens=this.tokenize(text),wordMappings=[],activeIndices=[],unknownWords=[];for(const word of tokens){const index=this.wordToIndex.get(word);void 0!==index?(wordMappings.push({word:word,index:index,found:!0}),activeIndices.includes(index)||activeIndices.push(index)):(wordMappings.push({word:word,index:null,found:!1}),unknownWords.push(word))}activeIndices.sort((a,b)=>a-b);const sentenceData={text:text,tokens:tokens,wordMappings:wordMappings,activeIndices:activeIndices,unknownWords:unknownWords};1===sentenceNum?this.sentence1Data=sentenceData:this.sentence2Data=sentenceData,this.displaySentenceResults(sentenceNum,sentenceData)}displaySentenceResults(sentenceNum,data){const mappingEl=1===sentenceNum?this.elements.sentence1Mapping:this.elements.sentence2Mapping,indicesEl=1===sentenceNum?this.elements.sentence1Indices:this.elements.sentence2Indices,mappingParts=data.wordMappings.map(item=>item.found?`<span class="word-found">${item.word}: ${item.index.toLocaleString()}</span>`:`<span class="word-not-found">${item.word}: NOT FOUND</span>`);if(mappingEl.innerHTML=mappingParts.join("; "),data.activeIndices.length>0){const indicesStr=data.activeIndices.map(i=>i.toLocaleString()).join("; ");indicesEl.innerHTML=`<span class="indices-list">[${indicesStr}]</span> <span class="indices-count">(${data.activeIndices.length} positions)</span>`}else indicesEl.innerHTML='<span style="color: #dc3545;">No valid words found in dictionary</span>'}compareSentences(){if(!this.sentence1Data||!this.sentence2Data)return void alert("Please analyze both sentences first.");if(0===this.sentence1Data.activeIndices.length||0===this.sentence2Data.activeIndices.length)return void alert("At least one sentence has no valid words. Cannot compare.");const similarity=this.cosineSimilarity(this.sentence1Data.activeIndices,this.sentence2Data.activeIndices),percentage=(100*similarity).toFixed(1);this.elements.similarityValue.textContent=`${percentage}%`,1===similarity?(this.elements.similarityValue.style.color="#28a745",this.elements.comparisonNote.innerHTML="<strong>Perfect match!</strong> Both sentences contain exactly the same words (order ignored).",this.elements.comparisonNote.style.color="#28a745"):similarity>.7?(this.elements.similarityValue.style.color="#5cb85c",this.elements.comparisonNote.innerHTML="High similarity - many shared words.",this.elements.comparisonNote.style.color="#5cb85c"):similarity>.3?(this.elements.similarityValue.style.color="#f0ad4e",this.elements.comparisonNote.innerHTML="Moderate similarity - some shared words.",this.elements.comparisonNote.style.color="#f0ad4e"):(this.elements.similarityValue.style.color="#d9534f",this.elements.comparisonNote.innerHTML="Low similarity - few shared words.",this.elements.comparisonNote.style.color="#d9534f");const sharedIndices=this.sentence1Data.activeIndices.filter(idx=>this.sentence2Data.activeIndices.includes(idx));console.log("Comparison:",{sentence1:this.sentence1Data.text,sentence2:this.sentence2Data.text,sentence1Indices:this.sentence1Data.activeIndices,sentence2Indices:this.sentence2Data.activeIndices,sharedIndices:sharedIndices,similarity:percentage+"%"})}cosineSimilarity(indices1,indices2){return indices1.filter(idx=>indices2.includes(idx)).length/(Math.sqrt(indices1.length)*Math.sqrt(indices2.length))}}